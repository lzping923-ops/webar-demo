<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>OpenWay WebAR</title>

  <style>
    html, body {
      height: 100%;
      margin: 0;
      background: #000;
      overflow: hidden;
    }

    /* camera */
    #cam {
      position: fixed;
      inset: 0;
      width: 100%;
      height: 100%;
      object-fit: cover;
      z-index: 0;
    }

    /* UI overlay */
    #ui {
      position: fixed;
      inset: 0;
      z-index: 10;
      pointer-events: none;
    }

    .el {
      position: absolute;
      user-select: none;
      -webkit-user-drag: none;
    }

    /* --- positions (tweak freely) --- */
    #back {
      left: 18px;
      top: 18px;
      width: 42px;
      opacity: 0.95;
    }

    /* scanning */
    #scanText {
      left: 50%;
      top: 22%;
      transform: translateX(-50%);
      width: min(82vw, 520px);
    }

    #scanFrame {
      left: 50%;
      top: 52%;
      transform: translate(-50%, -50%);
      width: min(72vw, 520px);
    }

    /* detected */
    #check {
      left: 50%;
      top: 30%;
      transform: translateX(-50%);
      width: 120px;
    }

    #detText {
      left: 50%;
      top: 46%;
      transform: translateX(-50%);
      width: min(70vw, 520px);
    }

    /* guide */
    #arrow {
      left: 18%;
      top: 48%;
      width: 140px;
    }

    #dots {
      left: 50%;
      top: 58%;
      transform: translateX(-50%);
      width: min(60vw, 420px);
    }

    /* blocked */
    #xmark {
      left: 50%;
      top: 30%;
      transform: translateX(-50%);
      width: 140px;
    }

    /* hint */
    #hint {
      position: fixed;
      left: 0;
      right: 0;
      bottom: 14px;
      text-align: center;
      color: #fff;
      font-size: 12px;
      opacity: 0.7;
      letter-spacing: 0.3px;
      z-index: 20;
      pointer-events: none;
    }
  </style>
</head>

<body>

  <!-- Camera -->
  <video id="cam" autoplay playsinline muted></video>

  <!-- UI elements -->
  <div id="ui">
    <img id="back" class="el" src="back.png" alt="Back" />

    <!-- scanning -->
    <img id="scanText" class="el" src="scan_text.png" alt="Scan text" />
    <img id="scanFrame" class="el" src="scan_frame.png" alt="Scan frame" />

    <!-- detected -->
    <img id="check" class="el" src="check.png" alt="Detected" />
    <img id="detText" class="el" src="detected_text.png" alt="Accessible Route Detected" />

    <!-- guide -->
    <img id="arrow" class="el" src="arrow.png" alt="Arrow" />
    <img id="dots" class="el" src="dots.png" alt="Dots" />

    <!-- blocked -->
    <img id="xmark" class="el" src="x.png" alt="Not Accessible" />
  </div>

  <div id="hint">Tap anywhere to continue</div>

  <script>
    /* states */
    const states = ["scanning", "detected", "guide", "blocked"];
    let step = 0;

    function show(id, on) {
      document.getElementById(id).style.display = on ? "" : "none";
    }

    function render(state) {
      // hide all
      [
        "scanText","scanFrame",
        "check","detText",
        "arrow","dots",
        "xmark"
      ].forEach(id => show(id, false));

      // always show back
      show("back", true);

      if (state === "scanning") {
        show("scanText", true);
        show("scanFrame", true);
      }

      if (state === "detected") {
        show("check", true);
        show("detText", true);
      }

      if (state === "guide") {
        show("arrow", true);
        show("dots", true);
      }

      if (state === "blocked") {
        show("xmark", true);
      }
    }

    async function startCamera() {
      try {
        const stream = await navigator.mediaDevices.getUserMedia({
          video: { facingMode: { ideal: "environment" } },
          audio: false
        });
        document.getElementById("cam").srcObject = stream;
      } catch (e) {
        alert("Please allow camera access and open on mobile.");
      }
    }

    /* tap to move next state */
    document.body.addEventListener("click", () => {
      step = Math.min(step + 1, states.length - 1);
      render(states[step]);
    });

    /* init */
    render(states[0]);
    startCamera();
  </script>

</body>
</html>

