<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>OpenWay WebAR</title>
  <style>
    html, body { height: 100%; margin: 0; background:#000; overflow:hidden; }
    #cam { position: fixed; inset:0; width:100%; height:100%; object-fit:cover; }

    /* UI layer on top of camera */
    #ui { position: fixed; inset:0; pointer-events:none; }
    .el { position:absolute; pointer-events:none; user-select:none; -webkit-user-drag:none; }

    /* positions (tweak later) */
    #back        { left: 18px; top: 18px; width: 44px; opacity: .95; }
    #scanText    { left: 50%; top: 22%; transform: translateX(-50%); width: min(82vw, 520px); }
    #scanFrame   { left: 50%; top: 52%; transform: translate(-50%,-50%); width: min(72vw, 520px); }

    #check       { left: 50%; top: 30%; transform: translateX(-50%); width: 120px; }
    #detText     { left: 50%; top: 46%; transform: translateX(-50%); width: min(70vw, 520px); }

    #arrow       { left: 18%; top: 48%; width: 140px; }
    #dots        { left: 50%; top: 58%; transform: translateX(-50%); width: min(60vw, 420px); }

    #xmark       { left: 50%; top: 28%; transform: translateX(-50%); width: 140px; }

    /* tap hint (optional) */
    #hint{
      position: fixed; left:0; right:0; bottom:16px;
      text-align:center; color:#fff; font: 13px system-ui;
      opacity:.75; letter-spacing:.2px;
      pointer-events:none;
    }
  </style>
</head>
<body>
  <video id="cam" autoplay playsinline muted></video>

  <div id="ui">
    <img id="back" class="el" src="back.png" alt="Back" />

    <!-- scanning -->
    <img id="scanText" class="el" src="scan_text.png" alt="Scan text" />
    <img id="scanFrame" class="el" src="scan_frame.png" alt="Scan frame" />

    <!-- detected -->
    <img id="check" class="el" src="check.png" alt="Detected" />
    <img id="detText" class="el" src="detected_text.png" alt="Accessible Route Detected" />

    <!-- guide -->
    <img id="arrow" class="el" src="arrow.png" alt="Arrow" />
    <img id="dots" class="el" src="dots.png" alt="Dots" />

    <!-- blocked -->
    <img id="xmark" class="el" src="x.png" alt="Not accessible" />
  </div>

  <div id="hint">Tap to continue</div>

  <script>
    // states: scanning -> detected -> guide -> blocked (optional)
    const states = ["scanning", "detected", "guide", "blocked"];
    let idx = 0;

    const showForState = (s) => {
      // hide all first
      const hide = (id, on) => document.getElementById(id).style.display = on ? "" : "none";

      // always show back
      hide("back", true);

      // scanning
      hide("scanText", s === "scanning");
      hide("scanFrame", s === "scanning");

      // detected
      hide("check",   s === "detected");
      hide("detText", s === "detected");

      // guide
      hide("arrow", s === "guide");
      hide("dots",  s === "guide");

      // blocked (optional)
      hide("xmark", s === "blocked");
    };

    async function startCamera(){
      try{
        const stream = await navigator.mediaDevices.getUserMedia({
          video: { facingMode: { ideal: "environment" } },
          audio: false
        });
        document.getElementById("cam").srcObject = stream;
      }catch(e){
        alert("Camera permission is required. Please open on mobile and allow camera.");
      }
    }

    // tap anywhere to step
    document.addEventListener("click", () => {
      idx = Math.min(idx + 1, states.length - 1);
      showForState(states[idx]);
    });

    // initial
    showForState(states[0]);
    startCamera();
  </script>
</body>
</html>
