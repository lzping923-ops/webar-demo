<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
<title>WebAR Flow ‚Äì Arrived</title>

<style>
:root{
  --yellow:#F5C542;
  --green:#34C759;
  --shadow:0 12px 30px rgba(0,0,0,.35);
}
html,body{
  margin:0;
  width:100%;
  height:100%;
  background:#000;
  overflow:hidden;
  font-family:system-ui;
}
#camera{
  position:fixed;
  inset:0;
  width:100%;
  height:100%;
  object-fit:cover;
}
#ui{
  position:fixed;
  inset:0;
  pointer-events:none;
}

/* states */
.state{
  position:absolute;
  inset:0;
  display:none;
  justify-content:center;
  align-items:center;
  text-align:center;
}
.state.active{display:flex;}

#clickLayer{
  position:absolute;
  inset:0;
  pointer-events:auto;
}

/* card */
.card{
  background:rgba(0,0,0,.35);
  border:1px solid rgba(255,255,255,.15);
  backdrop-filter:blur(10px);
  border-radius:18px;
  padding:16px;
  max-width:80%;
  color:#fff;
  box-shadow:var(--shadow);
}
.title{font-size:18px;font-weight:700;margin-bottom:6px;}
.sub{font-size:14px;opacity:.85}

/* arrow */
#arrow{
  position:absolute;
  bottom:45%;
  left:50%;
  transform:translateX(-50%);
  width:70px;
  display:none;
  filter:drop-shadow(0 12px 22px rgba(0,0,0,.35));
}

/* route dots */
#route{
  position:absolute;
  bottom:22%;
  left:50%;
  transform:translateX(-50%);
  display:flex;
  flex-direction:column;
  gap:14px;
}
.dot{
  width:14px;
  height:14px;
  border-radius:50%;
  background:var(--yellow);
  opacity:.8;
}

/* arrived card */
.arrived{
  position:absolute;
  bottom:18%;
  left:50%;
  transform:translateX(-50%);
  width:82%;
}
.arrived h3{
  margin:0 0 8px 0;
  font-size:18px;
}
.arrived ul{
  margin:0;
  padding-left:18px;
  text-align:left;
  font-size:14px;
  opacity:.9;
}
</style>
</head>

<body>

<video id="camera" autoplay playsinline muted></video>

<div id="ui">

  <div id="clickLayer"></div>

  <!-- START -->
  <div class="state active" id="state-start">
    <div class="card">
      <div class="title">Start Scan</div>
      <div class="sub">Tap to start AR scanning</div>
    </div>
  </div>

  <!-- SCAN -->
  <div class="state" id="state-scan">
    <div class="card">
      <div class="title">Scanning</div>
      <div class="sub">Detecting environment‚Ä¶</div>
    </div>
  </div>

  <!-- DETECTED -->
  <div class="state" id="state-detected">
    <div class="card">
      <div class="title">Accessible Route Found</div>
      <div class="sub">Tap to start guidance</div>
    </div>
  </div>

  <!-- GUIDE -->
  <div class="state" id="state-guide">
    <img id="arrow" src="arrow.png" />
    <div id="route">
      <div class="dot"></div>
      <div class="dot"></div>
      <div class="dot"></div>
      <div class="dot"></div>
    </div>
  </div>

  <!-- ARRIVED -->
  <div class="state" id="state-arrived">
    <div class="card arrived">
      <h3>üìç Library ‚Äì Hamzah Sendut</h3>
      <ul>
        <li>Wheelchair-accessible entrance</li>
        <li>Lift access to all floors</li>
        <li>Accessible restroom available</li>
        <li>Wide circulation paths</li>
      </ul>
    </div>
  </div>

</div>

<script>
const states=[
  "state-start",
  "state-scan",
  "state-detected",
  "state-guide",
  "state-arrived"
];

function show(id){
  states.forEach(s=>document.getElementById(s).classList.remove("active"));
  document.getElementById(id).classList.add("active");
  document.getElementById("arrow").style.display =
    (id==="state-guide")?"block":"none";
}

async function startCamera(){
  const stream=await navigator.mediaDevices.getUserMedia({
    video:{facingMode:"environment"}
  });
  document.getElementById("camera").srcObject=stream;
}

let step=0;
document.getElementById("clickLayer").addEventListener("click",async()=>{
  if(step===0){await startCamera();show("state-scan");}
  if(step===1){show("state-detected");}
  if(step===2){show("state-guide");}
  if(step===3){show("state-arrived");}
  step=(step+1)%5;
});
</script>

</body>
</html>

